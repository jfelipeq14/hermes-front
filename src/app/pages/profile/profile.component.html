<div class="card">
    <h3 class="p-0 m-0 text-center">Perfil de Usuario</h3>

    <div *ngIf="loading" class="flex justify-content-center">
        <p-progressSpinner></p-progressSpinner>
    </div>

    <div *ngIf="!loading">
        <div class="flex flex-row gap-4">
            <!-- Información Personal -->
            <fieldset class="container flex flex-col flex-1 gap-4">
                <legend class="my-2 font-bold">Información Personal</legend>
                <div class="flex flex-col">
                    <label for="typeDocument" class="flex-1">Tipo de Documento</label>
                    <p-dropdown id="typeDocument" class="flex-1" [options]="typesDocument" [(ngModel)]="user.typeDocument" optionLabel="name" optionValue="value" [disabled]="!editMode" [filter]="true" filterBy="name"> </p-dropdown>
                </div>

                <div class="flex flex-col">
                    <label for="document">Número de Documento</label>
                    <input id="document" type="text" pInputText [(ngModel)]="user.document" [disabled]="!editMode" />
                </div>

                <div class="flex flex-col">
                    <label for="name">Nombre</label>
                    <input id="name" type="text" pInputText [(ngModel)]="user.name" [disabled]="!editMode" />
                </div>

                <div class="flex flex-col">
                    <label for="surName">Apellido</label>
                    <input id="surName" type="text" pInputText [(ngModel)]="user.surName" [disabled]="!editMode" />
                </div>

                <div class="flex flex-col">
                    <label for="dateBirth">Fecha de Nacimiento</label>
                    <p-calendar id="dateBirth" [(ngModel)]="user.dateBirth" [showIcon]="true" [disabled]="!editMode" dateFormat="dd/mm/yy"> </p-calendar>
                </div>

                <div class="flex flex-col">
                    <label for="sex">Sexo</label>
                    <p-dropdown id="sex" [options]="sexlist" [(ngModel)]="user.sex" optionLabel="name" optionValue="value" [disabled]="!editMode" [filter]="true" filterBy="name"> </p-dropdown>
                </div>
            </fieldset>

            <!-- Información de Contacto -->
            <fieldset class="container flex flex-col flex-1 gap-4">
                <legend class="my-2 font-bold">Información de Contacto</legend>
                <div class="flex flex-col">
                    <label for="email">Correo Electrónico</label>
                    <input id="email" type="email" pInputText [(ngModel)]="user.email" [disabled]="!editMode" />
                </div>

                <div class="flex flex-col">
                    <label for="phone">Teléfono</label>
                    <input id="phone" type="text" pInputText [(ngModel)]="user.phone" [disabled]="!editMode" />
                </div>

                <div class="flex flex-col">
                    <label for="emergency">Contacto de Emergencia</label>
                    <input id="emergency" type="text" pInputText [(ngModel)]="user.emergency" [disabled]="!editMode" />
                </div>

                <div class="flex flex-col">
                    <label for="idMunicipality">Municipio</label>
                    <p-dropdown id="idMunicipality" [options]="municipalities" [(ngModel)]="user.idMunicipality" optionLabel="name" optionValue="id" [disabled]="!editMode" [filter]="true" filterBy="name"> </p-dropdown>
                </div>

                <div class="flex flex-col">
                    <label for="address">Dirección</label>
                    <input id="address" type="text" pInputText [(ngModel)]="user.address" [disabled]="!editMode" />
                </div>
            </fieldset>

            <!-- Información Médica -->
            <fieldset class="container flex flex-col flex-1 gap-4">
                <legend class="my-2 font-bold">Información Médica</legend>
                <div class="flex flex-col">
                    <label for="bloodType">Tipo de Sangre</label>
                    <p-dropdown id="bloodType" [options]="bloodTypes" [(ngModel)]="user.bloodType" optionLabel="name" optionValue="value" [disabled]="!editMode" [filter]="true" filterBy="name"> </p-dropdown>
                </div>

                <div class="flex flex-col">
                    <label for="eps">EPS</label>
                    <p-dropdown id="eps" [options]="epslist" [(ngModel)]="user.eps" optionLabel="name" optionValue="value" [disabled]="!editMode" [filter]="true" filterBy="name"> </p-dropdown>
                </div>
            </fieldset>
        </div>

        <!-- Botones de acción -->
        <div class="flex gap-2 my-2 justify-content-end">
            <button *ngIf="!editMode" pButton pRipple label="Editar Perfil" icon="pi pi-pencil" class="p-button-primary" (click)="enableEditMode()"></button>

            <div *ngIf="editMode" class="flex gap-2">
                <button pButton pRipple label="Cancelar" icon="pi pi-times" class="p-button-secondary" (click)="cancelEdit()"></button>
                <button pButton pRipple label="Guardar Cambios" icon="pi pi-check" class="p-button-success" (click)="saveChanges()"></button>
            </div>
        </div>
    </div>
</div>

<p-toast></p-toast>
<p-confirmDialog [style]="{ width: '450px' }"></p-confirmDialog>
